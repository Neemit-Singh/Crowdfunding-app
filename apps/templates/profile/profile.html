{% extends 'layouts/base.html' %}
{% load index %}
{% block title %} Profile {% endblock title %}

<!-- Specific CSS goes HERE-->
{% block stylesheets %}
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="../../static/assets/css/user-profile.css">
{% endblock stylesheets %}

{% block body_class %} profile-body {% endblock body_class %}

{% block content %}
<div id="user-profile" class="container my-5 py-5">
    <div class="row">
        <!-- left panel -->
        <div class="col-md-3 profile-nav shadow-lg h-100 p-0">
            <div class="user-heading round bg-gradient-primary ">
                <img src="{{user.profile_img.url}}" class="card-img-top border border-2 rounded-circle w-75 mt-2"
                    alt="profile img">
                <h1 class="text-white font-weight-bolder mt-2 ">{{user.first_name|title}} {{user.last_name|title}}
                </h1>
                <p>{{user.email}}</p>
            </div>
            <ul class="nav flex-column bg-white">
                <li><a href="{% url 'editProfile'  %}"> <i class="fa fa-edit text-center" style="width: 30px;"></i> Edit profile</a>
                </li>
                <li><a href="{% url 'create_project'  %}"> <i class="fa fa-plus text-center" style="width: 30px;"></i> Create
                        Project</a></li>
                <li><a href="{% url 'deleteAccount'  %}"> <i class="fa fa-user-slash text-center" style="width: 30px;"></i> Delete
                        Account</a></li>
            </ul>
        </div>

        <!-- right panel -->
        <div class="col-md-9">
            <div class="row">
                <!-- User Details -->
                <div class="col-md-9 ">
                    <div class="profile-info shadow-lg p-0">
                        <div class="bio-graph-info bg-white rounded px-5 py-4 d-flex justify-content-around">
                            <div class="d-flex">
                                <div class="">
                                    <p>First Name :</p>
                                    <p>Last Name :</p>
                                    <p>Country :</p>
                                </div>
                                <div class="">
                                    <p class="mx-2 text-dark font-weight-bold">{{user.first_name|title}}</p>
                                    <p class="mx-2 text-dark font-weight-bold">{{user.last_name|title}}</p>
                                    {% if user.country %}
                                    {{ user.country }}
                                    {% else %}
                                    <p class="mx-2  font-weight-bold"><a class="text-dark"
                                            href="{% url 'editProfile'  %}">click
                                            to add</a></p>
                                    {% endif %}
                                </div>
                            </div>

                            <div class="d-flex">
                                <div class="">
                                    <p>Email :</p>
                                    <p>Mobile :</p>
                                    <p>Birthday :</p>
                                </div>
                                <div class="">
                                    <p class="mx-2 text-dark font-weight-bold">{{user.email}}</p>
                                    <p class="mx-2 text-dark font-weight-bold">{{ user.phone }}</p>
                                    {% if user.birthdate %}
                                    {{ user.birthdate }}
                                    {% else %}
                                    <p class="mx-2 text-dark font-weight-bold"><a class="text-dark"
                                            href="{% url 'editProfile'  %}">click
                                            to add</a></p>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Statistics -->
                <div class="col-md-3 profile-info d-flex flex-column justify-content-between">
                    <div class="row">
                        <div class="col-md-12 bg-white rounded px-4 py-4 d-flex shadow-lg p-0">
                            <h5><i class="fa fa-coins text-primary"></i></h5>
                            <h5 class="mx-3">{{ donations|length }} <span
                                    class="text-light text-dark mx-1">Donations</span></h5>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 bg-white rounded px-4 py-4 d-flex shadow-lg p-0">
                            <h5><i class="fa fa-chart-pie text-primary"></i></i></h5>
                            <h5 class="mx-3">{{ projects|length }} <span
                                    class="text-light text-dark mx-1">Projects</span></h5>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Table -->
            <div class="row">
                <div class="col-md-12 mt-3" style="padding-right: 0;">
                    <table class="table table-hover bg-white rounded shadow-lg p-0 text-center">
                        <thead>
                            <tr>
                                <th class="px-5 py-3" scope="col">Title</th>
                                <th class="px-5 py-3" scope="col">Donation</th>
                                <th class="px-5 py-3 " scope="col">Created at</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for donation in donations%}
                            <tr>
                                <td class="px-5 py-3">
                                    <a href="{% url 'show_project'  donation.project_id %}">
                                        {{donation.project.title|truncatewords:2}}
                                    </a>
                                </td>
                                <td class="px-5 py-3">{{donation.donation}} $ </td>
                                <td class="px-5 py-3">{{donation.created_at | date:"m d,Y"}}</td>
                            </tr>
                            {%endfor%}
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="row">
                <div class="col-md-12 " style="padding-right: 0;">
                    <div class="row">
                        {% for project in projects%}
                        <div class="col-md-4">
                            <a href="{% url 'show_project' project.id %}">
                                <div style="height:150px">
                                    <img src="{{ images|index:forloop.counter0 }}" alt="project-img"
                                        class="img-fluid rounded" style="height: inherit; width: 100%;">
                                </div>
                            </a>
                            <div class="d-flex justify-content-between bg-white px-3 pt-3 mb-0">
                                <a href="{% url 'show_project' project.id %}">
                                    <h5>{{ project.title|title }}</h5>
                                </a>
                                <p><i class="fa-solid fa-dollar-sign"></i>
                                    {{project.total_target}}
                                </p>
                            </div>
                            <a href="{% url 'show_project' project.id %}">
                                <p class="bg-white px-3 pb-3">{{project.details|truncatewords:20}}</p>
                            </a>
                        </div>
                        {%endfor%}
                    </div>
                </div>
            </div>

        </div>
    </div>
</div>

{% endblock content %}